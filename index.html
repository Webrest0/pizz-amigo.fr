<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PIZZ’AMIGO — Montmerle-sur-Saône</title>
<meta name="color-scheme" content="dark">
<style>
:root{--bg:#0b0f14;--panel:#121a2b;--line:#243156;--muted:#b9c2d6;--green:#19c37d;--orange:#ff9f3f}
html,body{margin:0;padding:0;background:var(--bg);color:#fff;font-family:system-ui,Segoe UI,Roboto,Arial}
a{color:#9ec5ff;text-decoration:none} a:hover{text-decoration:underline}
.container{max-width:1050px;margin:0 auto;padding:0 14px}

/* HERO – image entière, pas recadrée */
.hero{padding:16px 14px 0}
.hero-card{position:relative;background:#0e1420;border:1px solid var(--line);border-radius:16px;overflow:hidden}
.hero-img{display:block;width:100%;aspect-ratio:16/9;object-fit:contain;object-position:center;background:#0e1420}
.hero-grad{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0) 50%, rgba(0,0,0,.55) 100%)}
.hero-txt{position:absolute;left:16px;right:16px;bottom:12px}
.brand{display:flex;align-items:center;gap:8px;font-weight:700;margin-bottom:6px}
.brand .dot{width:10px;height:10px;border-radius:99px;background:#2bff8a;box-shadow:0 0 10px #1ee07a}
h1{font-size:clamp(22px,4.6vw,40px);line-height:1.08;margin:0 0 4px}
.lead{margin:0;opacity:.9}

/* Bandeau état */
.badge{display:flex;gap:10px;align-items:center;background:#3a1e1e;border:1px solid #774646;color:#ffd3d3;padding:12px 14px;border-radius:12px;margin:12px 14px}
.badge .dot{width:10px;height:10px;border-radius:99px;background:#ff6969;box-shadow:0 0 0 3px rgba(255,105,105,.18)}

/* Sections */
section{padding:18px 14px} h2{font-size:26px;margin:0 0 6px}
.note{color:var(--muted)}

/* Carte */
.list{list-style:none;margin:12px 0 26px;padding:0}
.item{display:flex;justify-content:space-between;gap:16px;padding:16px 10px;border-bottom:1px solid rgba(255,255,255,.07)}
.it-left{max-width:72%}
.it-title{font-weight:700;font-size:18px}
.it-desc{opacity:.85;margin-top:4px}
.it-right{text-align:right;display:flex;gap:12px;align-items:center}
.price{color:#32a852;font-weight:700;min-width:72px}
.btn{cursor:pointer;padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.22);background:transparent;color:#fff}
.btn.primary{background:var(--green);border:0;color:#000}
.btn.orange{border-color:var(--orange);color:var(--orange)}
.btn.small{padding:6px 10px;font-size:13px}

.card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:16px;margin:12px 0}
.card h3{margin:0 0 10px}
.small{opacity:.8}
.footer{padding:30px 14px 90px;color:#cfd6e6}

/* Panier sticky */
#cartBar{position:sticky;bottom:0;left:0;right:0;display:none;justify-content:center;gap:10px;align-items:center;padding:10px;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);border-top:1px solid rgba(255,255,255,.08);z-index:50}
#cartBar.show{display:flex}

/* Modal */
dialog{border:1px solid var(--line);background:var(--panel);color:#fff;border-radius:14px;max-width:720px;width:95%}
dialog::backdrop{background:rgba(0,0,0,.6)}
#ck-list{white-space:pre-wrap;background:#0e1420;border:1px dashed #2a3d6b;border-radius:10px;padding:10px;margin:10px 0}
.form label{display:block;margin:10px 0 4px}
.form input,.form textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#0e1420;color:#fff}
.two{display:grid;grid-template-columns:1fr 1fr;gap:12px}
hr.sep{border:0;border-top:1px solid rgba(255,255,255,.08);margin:12px 0}
</style>
</head>
<body>

<!-- HERO -->
<div class="hero">
  <div class="hero-card">
    <img class="hero-img" src="./images/oven.jpg" alt="Four à pizza">
    <div class="hero-grad"></div>
    <div class="hero-txt">
      <div class="brand"><span class="dot"></span>PIZZ’AMIGO</div>
      <h1>PIZZ’AMIGO — Montmerle-sur-Saône</h1>
      <p class="lead">Le goût authentique de l’Italie près de chez vous.</p>
    </div>
  </div>
</div>

<!-- Bandeau info -->
<div class="badge"><span class="dot"></span><strong>Fermé pour le moment</strong> — retrouvez-nous ce week-end !</div>

<div class="container">
  <section>
    <h2>Notre carte</h2>
    <p class="note">Boissons : réglez en ligne, <strong>saveur choisie sur place</strong>.<br>
      <em>Supplément</em> (viande / poisson / œuf / fromage) : <strong>+1 €</strong> par ajout.</p>

    <!-- ======== CARTE COMPLÈTE ======== -->
    <ul id="menu" class="list">
      <!-- PIZZAS -->
      <li class="item" data-name="Margharita" data-price="7.5"><div class="it-left"><div class="it-title">Margharita</div><div class="it-desc">tomate, emmental</div></div><div class="it-right"><div class="price">7,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Chasseur" data-price="8.5"><div class="it-left"><div class="it-title">Chasseur</div><div class="it-desc">tomate, emmental, champignons</div></div><div class="it-right"><div class="price">8,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Sicilienne" data-price="8.5"><div class="it-left"><div class="it-title">Sicilienne</div><div class="it-desc">tomate, emmental, anchois</div></div><div class="it-right"><div class="price">8,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Napolitaine" data-price="9"><div class="it-left"><div class="it-title">Napolitaine</div><div class="it-desc">tomate, emmental, jambon</div></div><div class="it-right"><div class="price">9,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Paysanne" data-price="9.5"><div class="it-left"><div class="it-title">Paysanne</div><div class="it-desc">tomate, emmental, jambon, œuf</div></div><div class="it-right"><div class="price">9,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Capri" data-price="9.5"><div class="it-left"><div class="it-title">Capri</div><div class="it-desc">tomate, emmental, jambon, champignons</div></div><div class="it-right"><div class="price">9,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Mozzarella" data-price="9.5"><div class="it-left"><div class="it-title">Mozzarella</div><div class="it-desc">tomate, emmental, mozzarella</div></div><div class="it-right"><div class="price">9,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Quatre Saisons" data-price="9.5"><div class="it-left"><div class="it-title">Quatre Saisons</div><div class="it-desc">tomate, emmental, oignons, champignons, poivrons, mozzarella</div></div><div class="it-right"><div class="price">9,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Vénitienne" data-price="9.5"><div class="it-left"><div class="it-title">Vénitienne</div><div class="it-desc">tomate, emmental, roquefort, oignons, crème</div></div><div class="it-right"><div class="price">9,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Oslo" data-price="10"><div class="it-left"><div class="it-title">Oslo</div><div class="it-desc">tomate, emmental, thon, champignons, crème</div></div><div class="it-right"><div class="price">10,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Orientale" data-price="10"><div class="it-left"><div class="it-title">Orientale</div><div class="it-desc">tomate, emmental, merguez, poivrons</div></div><div class="it-right"><div class="price">10,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Bolognaise" data-price="10"><div class="it-left"><div class="it-title">Bolognaise</div><div class="it-desc">tomate, emmental, viande hachée, crème, mozzarella</div></div><div class="it-right"><div class="price">10,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Fermière" data-price="10"><div class="it-left"><div class="it-title">Fermière</div><div class="it-desc">tomate, emmental, œuf, lardons, champignons</div></div><div class="it-right"><div class="price">10,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Miel" data-price="10.5"><div class="it-left"><div class="it-title">Miel</div><div class="it-desc">crème, emmental, chèvre frais, miel</div></div><div class="it-right"><div class="price">10,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Forestière" data-price="10.5"><div class="it-left"><div class="it-title">Forestière</div><div class="it-desc">tomate, emmental, poulet, champignons, crème</div></div><div class="it-right"><div class="price">10,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Lyonnaise" data-price="11"><div class="it-left"><div class="it-title">Lyonnaise</div><div class="it-desc">tomate, emmental, saint-marcellin, poulet, crème</div></div><div class="it-right"><div class="price">11,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Quatre Fromages" data-price="11"><div class="it-left"><div class="it-title">Quatre Fromages</div><div class="it-desc">tomate, emmental, chèvre, roquefort, mozzarella</div></div><div class="it-right"><div class="price">11,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Paradoxe" data-price="11"><div class="it-left"><div class="it-title">Paradoxe</div><div class="it-desc">tomate, emmental, œuf, jambon, chorizo, mozzarella</div></div><div class="it-right"><div class="price">11,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Boisée" data-price="11"><div class="it-left"><div class="it-title">Boisée</div><div class="it-desc">crème, emmental, pomme de terre, poulet, poivrons, sauce gruyère</div></div><div class="it-right"><div class="price">11,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Savoyarde" data-price="11"><div class="it-left"><div class="it-title">Savoyarde</div><div class="it-desc">emmental, lardons, reblochon, pomme de terre, crème</div></div><div class="it-right"><div class="price">11,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Carnivore" data-price="11.5"><div class="it-left"><div class="it-title">Carnivore</div><div class="it-desc">tomate, emmental, viande hachée, merguez, œuf, mozzarella</div></div><div class="it-right"><div class="price">11,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Norvégienne" data-price="11.5"><div class="it-left"><div class="it-title">Norvégienne</div><div class="it-desc">emmental, saumon fumé, mozzarella, crème</div></div><div class="it-right"><div class="price">11,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Burger" data-price="12"><div class="it-left"><div class="it-title">Burger</div><div class="it-desc">tomate, emmental, viande hachée, oignons, cheddar, tomate cerise, sauce burger</div></div><div class="it-right"><div class="price">12,00 €</div><button class="btn orange add">Ajouter</button></div></li>
      <!-- BOISSONS -->
      <li class="item" data-name="Canette 33cl (choix sur place)" data-price="1.5"><div class="it-left"><div class="it-title">Canette 33cl (choix sur place)</div><div class="it-desc">boisson — saveur choisie sur place</div></div><div class="it-right"><div class="price">1,50 €</div><button class="btn orange add">Ajouter</button></div></li>
      <li class="item" data-name="Bouteille 50cl (choix sur place)" data-price="3"><div class="it-left"><div class="it-title">Bouteille 50cl (choix sur place)</div><div class="it-desc">boisson — saveur choisie sur place</div></div><div class="it-right"><div class="price">3,00 €</div><button class="btn orange add">Ajouter</button></div></li>
    </ul>

    <div class="card">
      <h3>Infos pratiques</h3>
      <div class="small">Nous trouver :</div>
      <ul>
        <li><strong>Vendredi soir</strong> — Saint-Georges-de-Reneins (Parking Caisse d’épargne) • 18:00–21:00 — <a href="https://maps.google.com/?q=Caisse+d'épargne+Saint-Georges-de-Reneins" target="_blank">Itinéraire</a></li>
        <li><strong>Samedi soir</strong> — Amareins (carrefour des feux) • 18:00–21:00 — <a href="https://maps.google.com/?q=Amareins+carrefour+des+feux" target="_blank">Itinéraire</a></li>
        <li><strong>Dimanche soir</strong> — Amareins (carrefour des feux) • 18:00–21:00 — <a href="https://maps.google.com/?q=Amareins+carrefour+des+feux" target="_blank">Itinéraire</a></li>
      </ul>
      <div style="margin-top:8px">Téléphone : <a href="tel:0680480456">06 80 48 04 56</a> • <a href="https://facebook.com" target="_blank">Facebook</a></div>
    </div>
  </section>

  <footer class="footer small">© PIZZ’AMIGO — Montmerle-sur-Saône</footer>
</div>

<!-- BARRE PANIER -->
<div id="cartBar">
  <span>Panier • <strong id="cartTotal">0,00</strong> €</span>
  <button id="btnView" class="btn">Voir panier</button>
  <button id="btnCheckout" class="btn primary">Passer commande</button>
</div>

<!-- MODAL -->
<dialog id="checkout">
  <form method="dialog">
    <h3>Finaliser la commande</h3>
    <div id="ck-list" class="small"></div>
    <div class="two">
      <div><label>Nom*</label><input id="ck-name" placeholder="Votre nom" autocomplete="name"></div>
      <div><label>Téléphone*</label><input id="ck-phone" placeholder="06…" inputmode="tel" autocomplete="tel"></div>
    </div>
    <div class="two">
      <div><label>Heure de retrait*</label><input id="ck-slot" value="19:00"></div>
      <div><label>Commentaire (optionnel)</label><input id="ck-note" placeholder="Sans olives, etc."></div>
    </div>
    <hr class="sep">
    <div style="display:flex;gap:10px;justify-content:flex-end">
      <button class="btn" id="btnClose">Fermer</button>
      <button class="btn primary" id="btnSend">Envoyer la commande</button>
    </div>
  </form>
</dialog>

<script>
/* ===== CONFIG API (vide = simulation) ===== */
const API_URL = ""; // ex: "https://script.google.com/macros/s/XXXX/exec"

/* ===== PANIER ===== */
const cart = {
  items: [], // {key,name, price, qty, sups, supsList}
  add(name, price, isDrink=false){
    let sups=0, supsList=[];
    if(!isDrink){
      if(confirm("Ajouter un supplément (+1 €) ?\n(viande / poisson / œuf / fromage)")){
        const t=(prompt("Type de supplément ? (viande / poisson / œuf / fromage)","")||"").trim();
        if(t){ sups=1; supsList=[t]; }
      }
    }
    const key=(name+"|"+supsList.join(",")).toLowerCase();
    const ex=this.items.find(i=>i.key===key);
    if(ex){ ex.qty++; } else this.items.push({key,name,price:parseFloat(price||0),qty:1,sups,supsList});
    renderCartBar();
  },
  total(){ return this.items.reduce((s,i)=> s + (i.price + (i.sups?1:0))*i.qty, 0); },
  clear(){ this.items.length=0; renderCartBar(); }
};
function €(v){ return v.toFixed(2).replace(".",","); }

/* Boutons “Ajouter” */
document.querySelectorAll("#menu .item").forEach(li=>{
  const name=li.dataset.name, price=parseFloat(li.dataset.price||"0");
  const isDrink = /choix sur place/i.test(name);
  li.querySelector(".add").addEventListener("click",()=>cart.add(name,price,isDrink));
});

/* Barre panier */
function renderCartBar(){
  const bar=document.getElementById("cartBar");
  document.getElementById("cartTotal").textContent=€(cart.total());
  bar.classList.toggle("show", cart.items.length>0);
}
document.getElementById("btnView").onclick=openCheckout;
document.getElementById("btnCheckout").onclick=openCheckout;

/* Modal + envoi */
function openCheckout(){
  if(cart.items.length===0){ alert("Votre panier est vide."); return; }
  const lines=cart.items.map(i=>{
    const sup=i.sups?` (+${i.sups} suppl. ${i.supsList.join(", ")})`:"";
    return `• ${i.name} × ${i.qty}${sup} — ${€(i.price)} €`;
  }).join("\n");
  document.getElementById("ck-list").textContent = lines + `\n\nTotal : ${€(cart.total())} €`;
  document.getElementById("checkout").showModal();
}
document.getElementById("btnClose").onclick=(e)=>{e.preventDefault();document.getElementById("checkout").close();};

document.getElementById("btnSend").onclick=async (e)=>{
  e.preventDefault();
  const name=document.getElementById("ck-name").value.trim();
  const phone=document.getElementById("ck-phone").value.trim();
  const slot=document.getElementById("ck-slot").value.trim();
  const note=document.getElementById("ck-note").value.trim();
  if(!name||!phone||!slot){ alert("Merci de compléter nom, téléphone et heure."); return; }

  const items=cart.items.map(i=>({name:i.name+(i.sups?` (+${i.sups} suppl.)`:""),qty:i.qty,price:i.price+(i.sups?1:0)}));
  const payload={name,phone,slot,note,items,total:Number(cart.total().toFixed(2)),source:"site"};

  if(!API_URL){
    alert("Commande enregistrée (simulation). Merci !");
    cart.clear(); document.getElementById("checkout").close(); return;
  }

  try{
    const res=await fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});
    const txt=await res.text(); let data; try{data=JSON.parse(txt);}catch{data={ok:false,error:"bad_json",raw:txt};}
    if(!res.ok||!data||data.ok!==true){ throw new Error((data&&data.error)||("HTTP "+res.status)); }
    alert("Commande enregistrée. Merci !");
    cart.clear(); document.getElementById("checkout").close();
  }catch(err){
    console.error(err); alert("Impossible d'envoyer la commande. Merci de réessayer ou de contacter le food-truck.");
  }
};
</script>
</body>
</html>
